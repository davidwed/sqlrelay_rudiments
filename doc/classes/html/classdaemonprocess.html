<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Rudiments: daemonprocess Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Rudiments</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">daemonprocess Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="daemonprocess" -->
<p><a href="classdaemonprocess-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#a53960365fab2b5434c685c430501cc96">detach</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#ab5e6fe3072300baa15e1344526169609">runAsUser</a> (const char *username) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#af7faf5a6c5e618b45376adf546784614">runAsGroup</a> (const char *groupname) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#a977905d1f158cf7dff910af9e1b7c76f">runAsUserId</a> (uid_t uid) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#af4fcc60d10fbfff279f78565825affeb">runAsGroupId</a> (gid_t gid) const </td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#ae50f2c550af4cb9cb213ca8a96168a0f">checkForPidFile</a> (const char *filename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#abc9ea9fa939d38417dda003c446ec42d">createPidFile</a> (const char *filename, mode_t <a class="el" href="classpermissions.html">permissions</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#a93fe8f99d11c1932c1e1f24e2de09a47">handleShutDown</a> (void(*shutdownfunction)(int32_t))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#a1d406b1e3d9d0a831c5e38f5ab190be2">handleCrash</a> (void(*crashfunction)(int32_t))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#a1084dd18bcedf4a0781b12e7ab0a6762">waitForChildren</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaemonprocess.html#aaae83bd22ebcd3c341f4fb6ddf771a6f">dontWaitForChildren</a> ()</td></tr>
</table>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ae50f2c550af4cb9cb213ca8a96168a0f"></a><!-- doxytag: member="daemonprocess::checkForPidFile" ref="ae50f2c550af4cb9cb213ca8a96168a0f" args="(const char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t daemonprocess::checkForPidFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks for filename "filename" and reads the process id out of it, if it exists. Returns the process id on success or -1 on failure. </p>

</div>
</div>
<a class="anchor" id="abc9ea9fa939d38417dda003c446ec42d"></a><!-- doxytag: member="daemonprocess::createPidFile" ref="abc9ea9fa939d38417dda003c446ec42d" args="(const char *filename, mode_t permissions)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool daemonprocess::createPidFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&#160;</td>
          <td class="paramname"><em>permissions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create's file "filename" with permissions "permissions" and puts the current process id in it. Note that when you delete this file during shutdown you must use the full pathname since the <a class="el" href="classdaemonprocess.html#a53960365fab2b5434c685c430501cc96">detach()</a> method below changes directories to "/". Returns true on success and false on failure. </p>

</div>
</div>
<a class="anchor" id="a53960365fab2b5434c685c430501cc96"></a><!-- doxytag: member="daemonprocess::detach" ref="a53960365fab2b5434c685c430501cc96" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool daemonprocess::detach </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Detach from the controlling terminal and process and run in the background. Also change directories to "/" and set the file creation mask such that all files are created -rw-rw-rw and all directories drwxrwxrwx. </p>

</div>
</div>
<a class="anchor" id="aaae83bd22ebcd3c341f4fb6ddf771a6f"></a><!-- doxytag: member="daemonprocess::dontWaitForChildren" ref="aaae83bd22ebcd3c341f4fb6ddf771a6f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void daemonprocess::dontWaitForChildren </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method causes the daemon not to wait on child processes which have exited. Ordinarily, you'd want to wait on child processes, but this interferes with the behavior of WEXITSTATUS() after a call to system() (and possibly other calls). This method allows you to disable waiting on child processes. </p>

</div>
</div>
<a class="anchor" id="a1d406b1e3d9d0a831c5e38f5ab190be2"></a><!-- doxytag: member="daemonprocess::handleCrash" ref="a1d406b1e3d9d0a831c5e38f5ab190be2" args="(void(*crashfunction)(int32_t))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void daemonprocess::handleCrash </td>
          <td>(</td>
          <td class="paramtype">void(*)(int32_t)&#160;</td>
          <td class="paramname"><em>crashfunction</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allows you to designate a function to run if the daemon crashes. </p>

</div>
</div>
<a class="anchor" id="a93fe8f99d11c1932c1e1f24e2de09a47"></a><!-- doxytag: member="daemonprocess::handleShutDown" ref="a93fe8f99d11c1932c1e1f24e2de09a47" args="(void(*shutdownfunction)(int32_t))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void daemonprocess::handleShutDown </td>
          <td>(</td>
          <td class="paramtype">void(*)(int32_t)&#160;</td>
          <td class="paramname"><em>shutdownfunction</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allows you to designate a function to run when the daemon is killed. </p>

</div>
</div>
<a class="anchor" id="af7faf5a6c5e618b45376adf546784614"></a><!-- doxytag: member="daemonprocess::runAsGroup" ref="af7faf5a6c5e618b45376adf546784614" args="(const char *groupname) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t daemonprocess::runAsGroup </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>groupname</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Causes the daemon to run as a different group than the one that started the process. It has no effect unless the process is started by the root user. It returns 1 on success, 0 on failure and -1 on error.</p>
<p>Note that this method uses the groupentry class. If you are using it in a multithreaded application, you may need to supply the groupentry class a mutex. See groupentry.h for more detail. </p>

</div>
</div>
<a class="anchor" id="af4fcc60d10fbfff279f78565825affeb"></a><!-- doxytag: member="daemonprocess::runAsGroupId" ref="af4fcc60d10fbfff279f78565825affeb" args="(gid_t gid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t daemonprocess::runAsGroupId </td>
          <td>(</td>
          <td class="paramtype">gid_t&#160;</td>
          <td class="paramname"><em>gid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Causes the daemon to run as a different group than the one that started the process. It has no effect unless the process is started by the root user. It returns 1 on success, 0 on failure and -1 on error. </p>

</div>
</div>
<a class="anchor" id="ab5e6fe3072300baa15e1344526169609"></a><!-- doxytag: member="daemonprocess::runAsUser" ref="ab5e6fe3072300baa15e1344526169609" args="(const char *username) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t daemonprocess::runAsUser </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Causes the daemon to run as a different user than the one that started the process. It has no effect unless the process is started by the root user. It returns 1 on success, 0 on failure and -1 on error.</p>
<p>Note that this method uses the passwdentry class. If you are using it in a multithreaded application, you may need to supply the passwdentry class a mutex. See passwdentry.h for more detail. </p>

</div>
</div>
<a class="anchor" id="a977905d1f158cf7dff910af9e1b7c76f"></a><!-- doxytag: member="daemonprocess::runAsUserId" ref="a977905d1f158cf7dff910af9e1b7c76f" args="(uid_t uid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t daemonprocess::runAsUserId </td>
          <td>(</td>
          <td class="paramtype">uid_t&#160;</td>
          <td class="paramname"><em>uid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Causes the daemon to run as a different user than the one that started the process. It has no effect unless the process is started by the root user. It returns 1 on success, 0 on failure and -1 on error. </p>

</div>
</div>
<a class="anchor" id="a1084dd18bcedf4a0781b12e7ab0a6762"></a><!-- doxytag: member="daemonprocess::waitForChildren" ref="a1084dd18bcedf4a0781b12e7ab0a6762" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void daemonprocess::waitForChildren </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method causes the daemon to wait on child processes which have exited, preventing so-called "zombie" processes from occurring. This method is called in the constructor and is thus the default behavior of this class. </p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Feb 23 2012 for Rudiments by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
