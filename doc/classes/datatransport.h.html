<html>
<head>
<title>/usr/local/src/rudiments-0.25/include/rudiments/datatransport.h.html</title>
<meta name="Generator" content="Vim/6.1">
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="#0000f8">// Copyright (c) 2002 David Muse</font>
<font color="#0000f8">// See the COPYING file for more information.</font>

<font color="#a020f0">#ifndef RUDIMENTS_DATATRANSPORT_H</font>
<font color="#a020f0">#define RUDIMENTS_DATATRANSPORT_H</font>

<font color="#a020f0">#include </font><font color="#f800f8">&lt;rudiments/filedescriptor.h&gt;</font>

<font color="#0000f8">// The datatransport class is a base class for other classes that transport data</font>
<font color="#0000f8">// over (or associated with) a file descriptor (such as clients and servers).</font>

<font color="#288850"><b>class</b></font> datatransport : <font color="#a02828"><b>public</b></font> filedescriptor {
        <font color="#a02828"><b>public</b></font>:

                        datatransport();
                                <font color="#0000f8">// Creates an uninitialized datatransport.</font>
                        datatransport(<font color="#288850"><b>int</b></font> fd);
                                <font color="#0000f8">// Creates a datatransport and associates the</font>
                                <font color="#0000f8">// already open file descriptor &quot;fd&quot; with it.</font>

                <font color="#0000f8">// Write methods - write data to the file descriptor.</font>
                <font color="#0000f8">// These methods return the number of bytes that were</font>
                <font color="#0000f8">// successfully written.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>short</b></font> number);
                                <font color="#0000f8">// Converts &quot;number&quot; to network byte order</font>
                                <font color="#0000f8">// and writes it to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>long</b></font> number);
                                <font color="#0000f8">// Converts &quot;number&quot; to network byte order</font>
                                <font color="#0000f8">// and writes it to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>float</b></font> number);
                                <font color="#0000f8">// Write &quot;number&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>double</b></font> number);
                                <font color="#0000f8">// Write &quot;number&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>char</b></font> character);
                                <font color="#0000f8">// Write &quot;character&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>char</b></font> *string);
                                <font color="#0000f8">// Write &quot;string&quot; to the file descriptor.  Note</font>
                                <font color="#0000f8">// that &quot;string&quot; must be NULL-terminated.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>char</b></font> *string, <font color="#288850"><b>size_t</b></font> size);
                                <font color="#0000f8">// Write &quot;size&quot; bytes from &quot;string&quot; to the file</font>
                                <font color="#0000f8">// descriptor.  Note that it is possible to</font>
                                <font color="#0000f8">// write beyond the string's NULL terminator</font>
                                <font color="#0000f8">// using this method.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>void</b></font> *buffer, <font color="#288850"><b>size_t</b></font> size);
                                <font color="#0000f8">// Write &quot;size&quot; bytes from &quot;buffer&quot; to the file</font>
                                <font color="#0000f8">// descriptor.</font>


                <font color="#0000f8">// Write methods - write data to the file descriptor with a</font>
                <font color="#0000f8">// timeout of &quot;sec&quot; seconds and &quot;usec&quot; microseconds.</font>
                <font color="#0000f8">// These methods return the number of bytes that were</font>
                <font color="#0000f8">// successfully written or -1 if a timeout occurred.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>short</b></font> number,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Converts &quot;number&quot; to network byte order</font>
                                <font color="#0000f8">// and writes it to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>long</b></font> number,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Converts &quot;number&quot; to network byte order</font>
                                <font color="#0000f8">// and writes it to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>float</b></font> number, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;number&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>double</b></font> number, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;number&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>char</b></font> character, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;character&quot; to the file descriptor.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>char</b></font> *string, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;string&quot; to the file descriptor.  Note</font>
                                <font color="#0000f8">// that &quot;string&quot; must be NULL-terminated.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>char</b></font> *string, <font color="#288850"><b>size_t</b></font> size,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;size&quot; bytes from &quot;string&quot; to the file</font>
                                <font color="#0000f8">// descriptor.  Note that it is possible to</font>
                                <font color="#0000f8">// write beyond the string's NULL terminator</font>
                                <font color="#0000f8">// using this method.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t write(<font color="#288850"><b>const</b></font> <font color="#288850"><b>void</b></font> *buffer, <font color="#288850"><b>size_t</b></font> size,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Write &quot;size&quot; bytes from &quot;buffer&quot; to the file</font>
                                <font color="#0000f8">// descriptor.</font>


                <font color="#0000f8">// Read methods - read data from the file descriptor.</font>
                <font color="#0000f8">// These methods return the number of bytes that were</font>
                <font color="#0000f8">// successfully read.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>short</b></font> *buffer);
                                <font color="#0000f8">// Reads sizeof(unsigned short) bytes</font>
                                <font color="#0000f8">// from the file descriptor into &quot;buffer&quot; and</font>
                                <font color="#0000f8">// converts &quot;buffer&quot; to host byte order.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>long</b></font> *buffer);
                                <font color="#0000f8">// Reads sizeof(unsigned short) bytes</font>
                                <font color="#0000f8">// from the file descriptor into &quot;buffer&quot; and</font>
                                <font color="#0000f8">// converts &quot;buffer&quot; to host byte order.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>float</b></font> *buffer);
                                <font color="#0000f8">// Reads sizeof(float) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>double</b></font> *buffer);
                                <font color="#0000f8">// Reads sizeof(double) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> *buffer);
                                <font color="#0000f8">// Reads sizeof(char) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> *buffer, <font color="#288850"><b>size_t</b></font> size);
                                <font color="#0000f8">// Reads &quot;size&quot; bytes from the file descriptor</font>
                                <font color="#0000f8">// into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>void</b></font> *buf, <font color="#288850"><b>size_t</b></font> size);
                                <font color="#0000f8">// Reads &quot;size&quot; bytes from the file descriptor</font>
                                <font color="#0000f8">// into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> **buffer, <font color="#288850"><b>char</b></font> *terminator);
                                <font color="#0000f8">// Reads from the file desciptor into &quot;buffer&quot;</font>
                                <font color="#0000f8">// until &quot;terminator&quot; is encountered.  Note</font>
                                <font color="#0000f8">// that &quot;buffer&quot; is allocated internally and</font>
                                <font color="#0000f8">// must be freed by the calling program.</font>


                <font color="#0000f8">// Read methods - read data from the file descriptor with a</font>
                <font color="#0000f8">// timeout of &quot;sec&quot; seconds and &quot;usec&quot; microseconds.</font>
                <font color="#0000f8">// These methods return the number of bytes that were</font>
                <font color="#0000f8">// successfully read or -1 if a timeout occurred.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>short</b></font> *buffer,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads sizeof(unsigned short) bytes</font>
                                <font color="#0000f8">// from the file descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>unsigned</b></font> <font color="#288850"><b>long</b></font> *buffer,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads sizeof(unsigned long) bytes</font>
                                <font color="#0000f8">// from the file descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>float</b></font> *buffer, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads sizeof(float) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>double</b></font> *buffer, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads sizeof(double) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> *buffer, <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads sizeof(char) bytes from the file</font>
                                <font color="#0000f8">// descriptor into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> *buffer, <font color="#288850"><b>size_t</b></font> size,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads &quot;size&quot; bytes from the file descriptor</font>
                                <font color="#0000f8">// into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>void</b></font> *buf, <font color="#288850"><b>size_t</b></font> size,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads &quot;size&quot; bytes from the file descriptor</font>
                                <font color="#0000f8">// into &quot;buffer&quot;.</font>
                <font color="#288850"><b>virtual</b></font> ssize_t read(<font color="#288850"><b>char</b></font> **buffer, <font color="#288850"><b>char</b></font> *terminator,
                                                        <font color="#288850"><b>long</b></font> sec, <font color="#288850"><b>long</b></font> usec);
                                <font color="#0000f8">// Reads from the file desciptor into &quot;buffer&quot;</font>
                                <font color="#0000f8">// until &quot;terminator&quot; is encountered.  Note</font>
                                <font color="#0000f8">// that &quot;buffer&quot; is allocated internally and</font>
                                <font color="#0000f8">// must be freed by the calling program.</font>

<font color="#a020f0">        #include </font><font color="#f800f8">&lt;rudiments/private/datatransport.h&gt;</font>
};

<font color="#a020f0">#ifdef ENABLE_INLINES</font>
<font color="#a020f0">        #include </font><font color="#f800f8">&lt;rudiments/private/datatransportinlines.h&gt;</font>
<font color="#a020f0">#endif</font>

<font color="#a020f0">#endif</font>
</pre>
</body>
</html>
