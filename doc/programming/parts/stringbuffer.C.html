






<pre>
<font color="#0000ff">// Copyright (c) 2002  David Muse</font>
<font color="#0000ff">// See the file COPYING for more information</font>

<font color="#a020f0">#include </font><font color="#ff00ff">&lt;rudiments/stringbuffer.h&gt;</font>
<font color="#a020f0">#include </font><font color="#ff00ff">&lt;stdio.h&gt;</font>

<font color="#a020f0">#ifdef RUDIMENTS_NAMESPACE</font>
<font color="#a52a2a"><b>using</b></font> <font color="#2e8b57"><b>namespace</b></font> rudiments;
<font color="#a020f0">#endif</font>


<font color="#2e8b57"><b>int</b></font> main(<font color="#2e8b57"><b>int</b></font> argc, <font color="#2e8b57"><b>const</b></font> <font color="#2e8b57"><b>char</b></font> **argv) {

        <font color="#0000ff">// create a new string buffer</font>
        stringbuffer    *str=<font color="#a52a2a"><b>new</b></font> stringbuffer();

        <font color="#0000ff">// append a NULL to the buffer</font>
        str-&gt;append((<font color="#2e8b57"><b>char</b></font> *)<font color="#ff00ff">NULL</font>);

        <font color="#0000ff">// append &quot;hello there world&quot; to the buffer in 3 parts</font>
        str-&gt;append(<font color="#ff00ff">&quot;hello &quot;</font>)-&gt;append(<font color="#ff00ff">&quot;there &quot;</font>)-&gt;append(<font color="#ff00ff">&quot;world &quot;</font>);

        <font color="#0000ff">// display the length and contents of the buffer</font>
        printf(<font color="#ff00ff">&quot;length: </font><font color="#6a5acd">%d</font><font color="#6a5acd">\n\&quot;</font><font color="#6a5acd">%s</font><font color="#6a5acd">\&quot;\n</font><font color="#ff00ff">&quot;</font>,str-&gt;getStringLength(),str-&gt;getString());


        <font color="#0000ff">// append some long integers to the buffer</font>
        str-&gt;append((<font color="#2e8b57"><b>int32_t</b></font>)<font color="#ff00ff">1</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append((<font color="#2e8b57"><b>int32_t</b></font>)<font color="#ff00ff">2</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append((<font color="#2e8b57"><b>int32_t</b></font>)<font color="#ff00ff">3</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append((<font color="#2e8b57"><b>int32_t</b></font>)<font color="#ff00ff">4</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append((<font color="#2e8b57"><b>int32_t</b></font>)<font color="#ff00ff">5</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);

        <font color="#0000ff">// display the length and contents of the buffer</font>
        printf(<font color="#ff00ff">&quot;length: </font><font color="#6a5acd">%d</font><font color="#6a5acd">\n\&quot;</font><font color="#6a5acd">%s</font><font color="#6a5acd">\&quot;\n</font><font color="#ff00ff">&quot;</font>,str-&gt;getStringLength(),str-&gt;getString());

        str-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);


        <font color="#0000ff">// append some floating point numbers to the buffer</font>
        str-&gt;append(<font color="#ff00ff">1.1</font>,<font color="#ff00ff">1</font>,<font color="#ff00ff">0</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append(<font color="#ff00ff">2.02</font>,<font color="#ff00ff">2</font>,<font color="#ff00ff">0</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append(<font color="#ff00ff">3.003</font>,<font color="#ff00ff">3</font>,<font color="#ff00ff">0</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append(<font color="#ff00ff">4.0004</font>,<font color="#ff00ff">4</font>,<font color="#ff00ff">0</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);
        str-&gt;append(<font color="#ff00ff">5.00005</font>,<font color="#ff00ff">5</font>,<font color="#ff00ff">0</font>)-&gt;append(<font color="#ff00ff">&quot; &quot;</font>);

        <font color="#0000ff">// display the length and contents of the buffer</font>
        printf(<font color="#ff00ff">&quot;length: </font><font color="#6a5acd">%d</font><font color="#6a5acd">\n\&quot;</font><font color="#6a5acd">%s</font><font color="#6a5acd">\&quot;\n</font><font color="#ff00ff">&quot;</font>,str-&gt;getStringLength(),str-&gt;getString());


        <font color="#0000ff">// clear the buffer</font>
        str-&gt;clear();


        <font color="#0000ff">// append 1024 *'s to the buffer and display it's length and contents</font>
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;<font color="#ff00ff">1024</font>; i++) {
                str-&gt;append(<font color="#ff00ff">'*'</font>);
        }
        printf(<font color="#ff00ff">&quot;length: </font><font color="#6a5acd">%d</font><font color="#6a5acd">\n</font><font color="#6a5acd">%s</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>,str-&gt;getStringLength(),str-&gt;getString());

        <font color="#0000ff">// delete the buffer</font>
        <font color="#a52a2a"><b>delete</b></font> str;




        <font color="#0000ff">// create another buffer</font>
        stringbuffer    *sb=<font color="#a52a2a"><b>new</b></font> stringbuffer();

        <font color="#0000ff">// append some string sequences to the buffer and display the contents</font>
        <font color="#0000ff">// of the buffer byte by byte</font>
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>unsigned</b></font> <font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;sb-&gt;getStringLength(); i++) {
                printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">%c</font><font color="#ff00ff">&quot;</font>,sb-&gt;getString()[i]);
        }
        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>);


        <font color="#0000ff">// write 66666 to the buffer at position 0 and display it's contents</font>
        <font color="#0000ff">// byte by byte (the first 5 bytes should be overwritten)</font>
        sb-&gt;setPosition(<font color="#ff00ff">0</font>);
        sb-&gt;write(<font color="#ff00ff">&quot;66666&quot;</font>);
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>unsigned</b></font> <font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;sb-&gt;getStringLength(); i++) {
                printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">%c</font><font color="#ff00ff">&quot;</font>,sb-&gt;getString()[i]);
        }
        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>);


        <font color="#0000ff">// write 66666 to the buffer at position 30 and display it's contents</font>
        <font color="#0000ff">// byte by byte, displaying nonprintable characters as .'s</font>
        <font color="#0000ff">// (there should be a gap in the buffer now containing random data)</font>
        sb-&gt;setPosition(<font color="#ff00ff">30</font>);
        sb-&gt;write(<font color="#ff00ff">&quot;66666&quot;</font>);
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;<font color="#ff00ff">35</font>; i++) {
                <font color="#a52a2a"><b>if</b></font> (sb-&gt;getString()[i]&gt;=<font color="#ff00ff">' '</font> &amp;&amp; sb-&gt;getString()[i]&lt;=<font color="#ff00ff">'~'</font>) {
                        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">%c</font><font color="#ff00ff">&quot;</font>,sb-&gt;getString()[i]);
                } <font color="#a52a2a"><b>else</b></font> {
                        printf(<font color="#ff00ff">&quot;.&quot;</font>);
                }
        }
        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>);


        <font color="#0000ff">// set the current position to 50</font>
        sb-&gt;setPosition(<font color="#ff00ff">50</font>);

        <font color="#0000ff">// Append 12345 to the buffer and display it's contents byte by byte,</font>
        <font color="#0000ff">// displaying nonprintable characters as .'s</font>
        <font color="#0000ff">// Since we used append() instead of write(), the data should not be</font>
        <font color="#0000ff">// written at position 50, but rather just at the current end of</font>
        <font color="#0000ff">// the buffer.</font>
        sb-&gt;append(<font color="#ff00ff">&quot;12345&quot;</font>);
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;<font color="#ff00ff">55</font>; i++) {
                <font color="#a52a2a"><b>if</b></font> (sb-&gt;getString()[i]&gt;=<font color="#ff00ff">' '</font> &amp;&amp; sb-&gt;getString()[i]&lt;=<font color="#ff00ff">'~'</font>) {
                        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">%c</font><font color="#ff00ff">&quot;</font>,sb-&gt;getString()[i]);
                } <font color="#a52a2a"><b>else</b></font> {
                        printf(<font color="#ff00ff">&quot;.&quot;</font>);
                }
        }
        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>);

        <font color="#0000ff">// Write 12345 to the buffer at the current position and display it's</font>
        <font color="#0000ff">// contents byte by byte, displaying nonprintable characters as .'s</font>
        <font color="#0000ff">// The current position should just be the end of the buffer, since</font>
        <font color="#0000ff">// we just appended.  So calling write() here is equivalent to calling</font>
        <font color="#0000ff">// append.</font>
        sb-&gt;write(<font color="#ff00ff">&quot;12345&quot;</font>);
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;<font color="#ff00ff">55</font>; i++) {
                <font color="#a52a2a"><b>if</b></font> (sb-&gt;getString()[i]&gt;=<font color="#ff00ff">' '</font> &amp;&amp; sb-&gt;getString()[i]&lt;=<font color="#ff00ff">'~'</font>) {
                        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">%c</font><font color="#ff00ff">&quot;</font>,sb-&gt;getString()[i]);
                } <font color="#a52a2a"><b>else</b></font> {
                        printf(<font color="#ff00ff">&quot;.&quot;</font>);
                }
        }
        printf(<font color="#ff00ff">&quot;</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>);


        <font color="#0000ff">// clear the buffer</font>
        sb-&gt;clear();

        <font color="#0000ff">// append 1024 0's to the buffer and display it's length and contents</font>
        <font color="#a52a2a"><b>for</b></font> (<font color="#2e8b57"><b>int</b></font> i=<font color="#ff00ff">0</font>; i&lt;<font color="#ff00ff">1024</font>; i++) {
                sb-&gt;append(<font color="#ff00ff">&quot;0&quot;</font>);
        }
        printf(<font color="#ff00ff">&quot;length: </font><font color="#6a5acd">%d</font><font color="#6a5acd">\n</font><font color="#6a5acd">%s</font><font color="#6a5acd">\n</font><font color="#ff00ff">&quot;</font>,str-&gt;getStringLength(),str-&gt;getString());

        <font color="#a52a2a"><b>delete</b></font> sb;
}
</pre>


